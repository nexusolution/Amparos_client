<!-- Modern User List Page -->
<div class="modern-page">

  <!-- Page Header -->
  <div class="page-header">
    <h1 class="page-title">Usuarios</h1>
    <div class="page-actions">
      <button
        type="button"
        class="btn-modern btn-primary-modern"
        (click)="addUser()"
        *ngIf="!isOperator">
        <svg class="btn-icon-modern" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"></line>
          <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
        Agregar Usuario
      </button>
    </div>
  </div>

  <!-- Users Table Card -->
  <div class="modern-card">
    <div class="card-header-modern">
      <h3 class="card-title-modern">Listado de Usuarios</h3>
    </div>

    <div class="card-body-modern">

      <!-- Loading State -->
      <div *ngIf="loading" class="text-center" style="padding: 40px 0;">
        <div class="loading-spinner" style="margin: 0 auto 16px;"></div>
        <p class="text-muted">Cargando usuarios...</p>
      </div>

      <!-- Empty State -->
      <div *ngIf="!loading && users.length === 0" class="text-center" style="padding: 40px 0;">
        <svg style="width: 64px; height: 64px; margin: 0 auto 16px; color: #d1d5db;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
          <circle cx="9" cy="7" r="4"></circle>
          <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
        </svg>
        <p class="text-muted">No hay usuarios registrados</p>
      </div>

      <!-- Users Table -->
      <div *ngIf="!loading && users.length > 0" class="modern-table-wrapper">
        <table class="modern-table">
          <thead>
            <tr>
              <th>Ã“rgano Jurisdiccional</th>
              <th>Nombre</th>
              <th>Apellido Paterno</th>
              <th>Apellido Materno</th>
              <th>Estatus</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let user of users">
              <td>{{ user.juzgado?.nombre || 'N/A' }}</td>
              <td>{{ user.nombre }}</td>
              <td>{{ user.apPaterno }}</td>
              <td>{{ user.apMaterno }}</td>
              <td>
                <span class="badge-modern badge-success-modern" *ngIf="user.estado === 'A'">
                  Activo
                </span>
                <span class="badge-modern badge-danger-modern" *ngIf="user.estado === 'I'">
                  Inactivo
                </span>
              </td>
              <td>
                <div style="display: flex; gap: 8px;">
                  <!-- Edit Button -->
                  <button
                    type="button"
                    class="btn-modern btn-sm-modern btn-primary-modern"
                    (click)="editUser(user)"
                    title="Editar usuario"
                    *ngIf="!isOperator">
                    <svg class="btn-icon-modern" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                      <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                    </svg>
                    Editar
                  </button>

                  <!-- Toggle Status Button -->
                  <button
                    type="button"
                    [class.btn-success-modern]="user.estado === 'I'"
                    [class.btn-warning-modern]="user.estado === 'A'"
                    class="btn-modern btn-sm-modern"
                    [title]="user.estado === 'A' ? 'Desactivar usuario' : 'Activar usuario'"
                    (click)="toggleUserStatus(user.idUsuario)"
                    *ngIf="!isOperator">
                    <svg class="btn-icon-modern" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" *ngIf="user.estado === 'A'">
                      <circle cx="12" cy="12" r="10"></circle>
                      <line x1="15" y1="9" x2="9" y2="15"></line>
                      <line x1="9" y1="9" x2="15" y2="15"></line>
                    </svg>
                    <svg class="btn-icon-modern" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" *ngIf="user.estado === 'I'">
                      <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    {{ user.estado === 'A' ? 'Desactivar' : 'Activar' }}
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>
  </div>

</div>
